(function(w,x){typeof exports=="object"&&typeof module<"u"?x(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],x):(w=typeof globalThis<"u"?globalThis:w||self,x(w.VueRough={},w.Vue))})(this,function(w,x){"use strict";function et(r,e,s){if(r&&r.length){const[t,n]=e,o=Math.PI/180*s,h=Math.cos(o),a=Math.sin(o);r.forEach(c=>{const[p,i]=c;c[0]=(p-t)*h-(i-n)*a+t,c[1]=(p-t)*a+(i-n)*h+n})}}function F(r){const e=r[0],s=r[1];return Math.sqrt(Math.pow(e[0]-s[0],2)+Math.pow(e[1]-s[1],2))}function j(r,e){const s=e.hachureAngle+90;let t=e.hachureGap;t<0&&(t=4*e.strokeWidth),t=Math.max(t,.1);const n=[0,0];if(s)for(const h of r)et(h,n,s);const o=function(h,a){const c=[];for(const u of h){const l=[...u];l[0].join(",")!==l[l.length-1].join(",")&&l.push([l[0][0],l[0][1]]),l.length>2&&c.push(l)}const p=[];a=Math.max(a,.1);const i=[];for(const u of c)for(let l=0;l<u.length-1;l++){const m=u[l],g=u[l+1];if(m[1]!==g[1]){const k=Math.min(m[1],g[1]);i.push({ymin:k,ymax:Math.max(m[1],g[1]),x:k===m[1]?m[0]:g[0],islope:(g[0]-m[0])/(g[1]-m[1])})}}if(i.sort((u,l)=>u.ymin<l.ymin?-1:u.ymin>l.ymin?1:u.x<l.x?-1:u.x>l.x?1:u.ymax===l.ymax?0:(u.ymax-l.ymax)/Math.abs(u.ymax-l.ymax)),!i.length)return p;let d=[],f=i[0].ymin;for(;d.length||i.length;){if(i.length){let u=-1;for(let l=0;l<i.length&&!(i[l].ymin>f);l++)u=l;i.splice(0,u+1).forEach(l=>{d.push({s:f,edge:l})})}if(d=d.filter(u=>!(u.edge.ymax<=f)),d.sort((u,l)=>u.edge.x===l.edge.x?0:(u.edge.x-l.edge.x)/Math.abs(u.edge.x-l.edge.x)),d.length>1)for(let u=0;u<d.length;u+=2){const l=u+1;if(l>=d.length)break;const m=d[u].edge,g=d[l].edge;p.push([[Math.round(m.x),f],[Math.round(g.x),f]])}f+=a,d.forEach(u=>{u.edge.x=u.edge.x+a*u.edge.islope})}return p}(r,t);if(s){for(const h of r)et(h,n,-s);(function(h,a,c){const p=[];h.forEach(i=>p.push(...i)),et(p,a,c)})(o,n,-s)}return o}class st{constructor(e){this.helper=e}fillPolygons(e,s){return this._fillPolygons(e,s)}_fillPolygons(e,s){const t=j(e,s);return{type:"fillSketch",ops:this.renderLines(t,s)}}renderLines(e,s){const t=[];for(const n of e)t.push(...this.helper.doubleLineOps(n[0][0],n[0][1],n[1][0],n[1][1],s));return t}}class qt extends st{fillPolygons(e,s){let t=s.hachureGap;t<0&&(t=4*s.strokeWidth),t=Math.max(t,.1);const n=j(e,Object.assign({},s,{hachureGap:t})),o=Math.PI/180*s.hachureAngle,h=[],a=.5*t*Math.cos(o),c=.5*t*Math.sin(o);for(const[p,i]of n)F([p,i])&&h.push([[p[0]-a,p[1]+c],[...i]],[[p[0]+a,p[1]-c],[...i]]);return{type:"fillSketch",ops:this.renderLines(h,s)}}}class Dt extends st{fillPolygons(e,s){const t=this._fillPolygons(e,s),n=Object.assign({},s,{hachureAngle:s.hachureAngle+90}),o=this._fillPolygons(e,n);return t.ops=t.ops.concat(o.ops),t}}class Et{constructor(e){this.helper=e}fillPolygons(e,s){const t=j(e,s=Object.assign({},s,{hachureAngle:0}));return this.dotsOnLines(t,s)}dotsOnLines(e,s){const t=[];let n=s.hachureGap;n<0&&(n=4*s.strokeWidth),n=Math.max(n,.1);let o=s.fillWeight;o<0&&(o=s.strokeWidth/2);const h=n/4;for(const a of e){const c=F(a),p=c/n,i=Math.ceil(p)-1,d=c-i*n,f=(a[0][0]+a[1][0])/2-n/4,u=Math.min(a[0][1],a[1][1]);for(let l=0;l<i;l++){const m=u+d+l*n,g=f-h+2*Math.random()*h,k=m-h+2*Math.random()*h,y=this.helper.ellipse(g,k,o,o,s);t.push(...y.ops)}}return{type:"fillSketch",ops:t}}}class It{constructor(e){this.helper=e}fillPolygons(e,s){const t=j(e,s);return{type:"fillSketch",ops:this.dashedLine(t,s)}}dashedLine(e,s){const t=s.dashOffset<0?s.hachureGap<0?4*s.strokeWidth:s.hachureGap:s.dashOffset,n=s.dashGap<0?s.hachureGap<0?4*s.strokeWidth:s.hachureGap:s.dashGap,o=[];return e.forEach(h=>{const a=F(h),c=Math.floor(a/(t+n)),p=(a+n-c*(t+n))/2;let i=h[0],d=h[1];i[0]>d[0]&&(i=h[1],d=h[0]);const f=Math.atan((d[1]-i[1])/(d[0]-i[0]));for(let u=0;u<c;u++){const l=u*(t+n),m=l+t,g=[i[0]+l*Math.cos(f)+p*Math.cos(f),i[1]+l*Math.sin(f)+p*Math.sin(f)],k=[i[0]+m*Math.cos(f)+p*Math.cos(f),i[1]+m*Math.sin(f)+p*Math.sin(f)];o.push(...this.helper.doubleLineOps(g[0],g[1],k[0],k[1],s))}}),o}}class zt{constructor(e){this.helper=e}fillPolygons(e,s){const t=s.hachureGap<0?4*s.strokeWidth:s.hachureGap,n=s.zigzagOffset<0?t:s.zigzagOffset,o=j(e,s=Object.assign({},s,{hachureGap:t+n}));return{type:"fillSketch",ops:this.zigzagLines(o,n,s)}}zigzagLines(e,s,t){const n=[];return e.forEach(o=>{const h=F(o),a=Math.round(h/(2*s));let c=o[0],p=o[1];c[0]>p[0]&&(c=o[1],p=o[0]);const i=Math.atan((p[1]-c[1])/(p[0]-c[0]));for(let d=0;d<a;d++){const f=2*d*s,u=2*(d+1)*s,l=Math.sqrt(2*Math.pow(s,2)),m=[c[0]+f*Math.cos(i),c[1]+f*Math.sin(i)],g=[c[0]+u*Math.cos(i),c[1]+u*Math.sin(i)],k=[m[0]+l*Math.cos(i+Math.PI/4),m[1]+l*Math.sin(i+Math.PI/4)];n.push(...this.helper.doubleLineOps(m[0],m[1],k[0],k[1],t),...this.helper.doubleLineOps(k[0],k[1],g[0],g[1],t))}}),n}}const P={};class Wt{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const B={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function nt(r,e){return r.type===e}function rt(r){const e=[],s=function(h){const a=new Array;for(;h!=="";)if(h.match(/^([ \t\r\n,]+)/))h=h.substr(RegExp.$1.length);else if(h.match(/^([aAcChHlLmMqQsStTvVzZ])/))a[a.length]={type:0,text:RegExp.$1},h=h.substr(RegExp.$1.length);else{if(!h.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];a[a.length]={type:1,text:`${parseFloat(RegExp.$1)}`},h=h.substr(RegExp.$1.length)}return a[a.length]={type:2,text:""},a}(r);let t="BOD",n=0,o=s[n];for(;!nt(o,2);){let h=0;const a=[];if(t==="BOD"){if(o.text!=="M"&&o.text!=="m")return rt("M0,0"+r);n++,h=B[o.text],t=o.text}else nt(o,1)?h=B[t]:(n++,h=B[o.text],t=o.text);if(!(n+h<s.length))throw new Error("Path data ended short");for(let c=n;c<n+h;c++){const p=s[c];if(!nt(p,1))throw new Error("Param not a number: "+t+","+p.text);a[a.length]=+p.text}if(typeof B[t]!="number")throw new Error("Bad segment: "+t);{const c={key:t,data:a};e.push(c),n+=h,o=s[n],t==="M"&&(t="L"),t==="m"&&(t="l")}}return e}function ht(r){let e=0,s=0,t=0,n=0;const o=[];for(const{key:h,data:a}of r)switch(h){case"M":o.push({key:"M",data:[...a]}),[e,s]=a,[t,n]=a;break;case"m":e+=a[0],s+=a[1],o.push({key:"M",data:[e,s]}),t=e,n=s;break;case"L":o.push({key:"L",data:[...a]}),[e,s]=a;break;case"l":e+=a[0],s+=a[1],o.push({key:"L",data:[e,s]});break;case"C":o.push({key:"C",data:[...a]}),e=a[4],s=a[5];break;case"c":{const c=a.map((p,i)=>i%2?p+s:p+e);o.push({key:"C",data:c}),e=c[4],s=c[5];break}case"Q":o.push({key:"Q",data:[...a]}),e=a[2],s=a[3];break;case"q":{const c=a.map((p,i)=>i%2?p+s:p+e);o.push({key:"Q",data:c}),e=c[2],s=c[3];break}case"A":o.push({key:"A",data:[...a]}),e=a[5],s=a[6];break;case"a":e+=a[5],s+=a[6],o.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],e,s]});break;case"H":o.push({key:"H",data:[...a]}),e=a[0];break;case"h":e+=a[0],o.push({key:"H",data:[e]});break;case"V":o.push({key:"V",data:[...a]}),s=a[0];break;case"v":s+=a[0],o.push({key:"V",data:[s]});break;case"S":o.push({key:"S",data:[...a]}),e=a[2],s=a[3];break;case"s":{const c=a.map((p,i)=>i%2?p+s:p+e);o.push({key:"S",data:c}),e=c[2],s=c[3];break}case"T":o.push({key:"T",data:[...a]}),e=a[0],s=a[1];break;case"t":e+=a[0],s+=a[1],o.push({key:"T",data:[e,s]});break;case"Z":case"z":o.push({key:"Z",data:[]}),e=t,s=n}return o}function it(r){const e=[];let s="",t=0,n=0,o=0,h=0,a=0,c=0;for(const{key:p,data:i}of r){switch(p){case"M":e.push({key:"M",data:[...i]}),[t,n]=i,[o,h]=i;break;case"C":e.push({key:"C",data:[...i]}),t=i[4],n=i[5],a=i[2],c=i[3];break;case"L":e.push({key:"L",data:[...i]}),[t,n]=i;break;case"H":t=i[0],e.push({key:"L",data:[t,n]});break;case"V":n=i[0],e.push({key:"L",data:[t,n]});break;case"S":{let d=0,f=0;s==="C"||s==="S"?(d=t+(t-a),f=n+(n-c)):(d=t,f=n),e.push({key:"C",data:[d,f,...i]}),a=i[0],c=i[1],t=i[2],n=i[3];break}case"T":{const[d,f]=i;let u=0,l=0;s==="Q"||s==="T"?(u=t+(t-a),l=n+(n-c)):(u=t,l=n);const m=t+2*(u-t)/3,g=n+2*(l-n)/3,k=d+2*(u-d)/3,y=f+2*(l-f)/3;e.push({key:"C",data:[m,g,k,y,d,f]}),a=u,c=l,t=d,n=f;break}case"Q":{const[d,f,u,l]=i,m=t+2*(d-t)/3,g=n+2*(f-n)/3,k=u+2*(d-u)/3,y=l+2*(f-l)/3;e.push({key:"C",data:[m,g,k,y,u,l]}),a=d,c=f,t=u,n=l;break}case"A":{const d=Math.abs(i[0]),f=Math.abs(i[1]),u=i[2],l=i[3],m=i[4],g=i[5],k=i[6];d===0||f===0?(e.push({key:"C",data:[t,n,g,k,g,k]}),t=g,n=k):(t!==g||n!==k)&&(lt(t,n,g,k,d,f,u,l,m).forEach(function(y){e.push({key:"C",data:y})}),t=g,n=k);break}case"Z":e.push({key:"Z",data:[]}),t=o,n=h}s=p}return e}function G(r,e,s){return[r*Math.cos(s)-e*Math.sin(s),r*Math.sin(s)+e*Math.cos(s)]}function lt(r,e,s,t,n,o,h,a,c,p){const i=(d=h,Math.PI*d/180);var d;let f=[],u=0,l=0,m=0,g=0;if(p)[u,l,m,g]=p;else{[r,e]=G(r,e,-i),[s,t]=G(s,t,-i);const L=(r-s)/2,v=(e-t)/2;let C=L*L/(n*n)+v*v/(o*o);C>1&&(C=Math.sqrt(C),n*=C,o*=C);const z=n*n,W=o*o,se=z*W-z*v*v-W*L*L,ne=z*v*v+W*L*L,At=(a===c?-1:1)*Math.sqrt(Math.abs(se/ne));m=At*n*v/o+(r+s)/2,g=At*-o*L/n+(e+t)/2,u=Math.asin(parseFloat(((e-g)/o).toFixed(9))),l=Math.asin(parseFloat(((t-g)/o).toFixed(9))),r<m&&(u=Math.PI-u),s<m&&(l=Math.PI-l),u<0&&(u=2*Math.PI+u),l<0&&(l=2*Math.PI+l),c&&u>l&&(u-=2*Math.PI),!c&&l>u&&(l-=2*Math.PI)}let k=l-u;if(Math.abs(k)>120*Math.PI/180){const L=l,v=s,C=t;l=c&&l>u?u+120*Math.PI/180*1:u+120*Math.PI/180*-1,f=lt(s=m+n*Math.cos(l),t=g+o*Math.sin(l),v,C,n,o,h,0,c,[l,L,m,g])}k=l-u;const y=Math.cos(u),O=Math.sin(u),R=Math.cos(l),b=Math.sin(l),_=Math.tan(k/4),q=4/3*n*_,T=4/3*o*_,tt=[r,e],$=[r+q*O,e-T*y],E=[s+q*b,t-T*R],Nt=[s,t];if($[0]=2*tt[0]-$[0],$[1]=2*tt[1]-$[1],p)return[$,E,Nt].concat(f);{f=[$,E,Nt].concat(f);const L=[];for(let v=0;v<f.length;v+=3){const C=G(f[v][0],f[v][1],i),z=G(f[v+1][0],f[v+1][1],i),W=G(f[v+2][0],f[v+2][1],i);L.push([C[0],C[1],z[0],z[1],W[0],W[1]])}return L}}const jt={randOffset:function(r,e){return M(r,e)},randOffsetWithRange:function(r,e,s){return H(r,e,s)},ellipse:function(r,e,s,t,n){const o=ut(s,t,n);return ot(r,e,n,o).opset},doubleLineOps:function(r,e,s,t,n){return N(r,e,s,t,n,!0)}};function ct(r,e,s,t,n){return{type:"path",ops:N(r,e,s,t,n)}}function Z(r,e,s){const t=(r||[]).length;if(t>2){const n=[];for(let o=0;o<t-1;o++)n.push(...N(r[o][0],r[o][1],r[o+1][0],r[o+1][1],s));return e&&n.push(...N(r[t-1][0],r[t-1][1],r[0][0],r[0][1],s)),{type:"path",ops:n}}return t===2?ct(r[0][0],r[0][1],r[1][0],r[1][1],s):{type:"path",ops:[]}}function Gt(r,e,s,t,n){return function(o,h){return Z(o,!0,h)}([[r,e],[r+s,e],[r+s,e+t],[r,e+t]],n)}function Vt(r,e){let s=gt(r,1*(1+.2*e.roughness),e);if(!e.disableMultiStroke){const t=gt(r,1.5*(1+.22*e.roughness),function(n){const o=Object.assign({},n);return o.randomizer=void 0,n.seed&&(o.seed=n.seed+1),o}(e));s=s.concat(t)}return{type:"path",ops:s}}function ut(r,e,s){const t=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(r/2,2)+Math.pow(e/2,2))/2)),n=Math.ceil(Math.max(s.curveStepCount,s.curveStepCount/Math.sqrt(200)*t)),o=2*Math.PI/n;let h=Math.abs(r/2),a=Math.abs(e/2);const c=1-s.curveFitting;return h+=M(h*c,s),a+=M(a*c,s),{increment:o,rx:h,ry:a}}function ot(r,e,s,t){const[n,o]=mt(t.increment,r,e,t.rx,t.ry,1,t.increment*H(.1,H(.4,1,s),s),s);let h=J(n,null,s);if(!s.disableMultiStroke&&s.roughness!==0){const[a]=mt(t.increment,r,e,t.rx,t.ry,1.5,0,s),c=J(a,null,s);h=h.concat(c)}return{estimatedPoints:o,opset:{type:"path",ops:h}}}function pt(r,e,s,t,n,o,h,a,c){const p=r,i=e;let d=Math.abs(s/2),f=Math.abs(t/2);d+=M(.01*d,c),f+=M(.01*f,c);let u=n,l=o;for(;u<0;)u+=2*Math.PI,l+=2*Math.PI;l-u>2*Math.PI&&(u=0,l=2*Math.PI);const m=2*Math.PI/c.curveStepCount,g=Math.min(m/2,(l-u)/2),k=Mt(g,p,i,d,f,u,l,1,c);if(!c.disableMultiStroke){const y=Mt(g,p,i,d,f,u,l,1.5,c);k.push(...y)}return h&&(a?k.push(...N(p,i,p+d*Math.cos(u),i+f*Math.sin(u),c),...N(p,i,p+d*Math.cos(l),i+f*Math.sin(l),c)):k.push({op:"lineTo",data:[p,i]},{op:"lineTo",data:[p+d*Math.cos(u),i+f*Math.sin(u)]})),{type:"path",ops:k}}function Q(r,e){const s=[];for(const t of r)if(t.length){const n=e.maxRandomnessOffset||0,o=t.length;if(o>2){s.push({op:"move",data:[t[0][0]+M(n,e),t[0][1]+M(n,e)]});for(let h=1;h<o;h++)s.push({op:"lineTo",data:[t[h][0]+M(n,e),t[h][1]+M(n,e)]})}}return{type:"fillPath",ops:s}}function I(r,e){return function(s,t){let n=s.fillStyle||"hachure";if(!P[n])switch(n){case"zigzag":P[n]||(P[n]=new qt(t));break;case"cross-hatch":P[n]||(P[n]=new Dt(t));break;case"dots":P[n]||(P[n]=new Et(t));break;case"dashed":P[n]||(P[n]=new It(t));break;case"zigzag-line":P[n]||(P[n]=new zt(t));break;case"hachure":default:n="hachure",P[n]||(P[n]=new st(t))}return P[n]}(e,jt).fillPolygons(r,e)}function ft(r){return r.randomizer||(r.randomizer=new Wt(r.seed||0)),r.randomizer.next()}function H(r,e,s,t=1){return s.roughness*t*(ft(s)*(e-r)+r)}function M(r,e,s=1){return H(-r,r,e,s)}function N(r,e,s,t,n,o=!1){const h=o?n.disableMultiStrokeFill:n.disableMultiStroke,a=dt(r,e,s,t,n,!0,!1);if(h)return a;const c=dt(r,e,s,t,n,!0,!0);return a.concat(c)}function dt(r,e,s,t,n,o,h){const a=Math.pow(r-s,2)+Math.pow(e-t,2),c=Math.sqrt(a);let p=1;p=c<200?1:c>500?.4:-.0016668*c+1.233334;let i=n.maxRandomnessOffset||0;i*i*100>a&&(i=c/10);const d=i/2,f=.2+.2*ft(n);let u=n.bowing*n.maxRandomnessOffset*(t-e)/200,l=n.bowing*n.maxRandomnessOffset*(r-s)/200;u=M(u,n,p),l=M(l,n,p);const m=[],g=()=>M(d,n,p),k=()=>M(i,n,p),y=n.preserveVertices;return o&&(h?m.push({op:"move",data:[r+(y?0:g()),e+(y?0:g())]}):m.push({op:"move",data:[r+(y?0:M(i,n,p)),e+(y?0:M(i,n,p))]})),h?m.push({op:"bcurveTo",data:[u+r+(s-r)*f+g(),l+e+(t-e)*f+g(),u+r+2*(s-r)*f+g(),l+e+2*(t-e)*f+g(),s+(y?0:g()),t+(y?0:g())]}):m.push({op:"bcurveTo",data:[u+r+(s-r)*f+k(),l+e+(t-e)*f+k(),u+r+2*(s-r)*f+k(),l+e+2*(t-e)*f+k(),s+(y?0:k()),t+(y?0:k())]}),m}function gt(r,e,s){const t=[];t.push([r[0][0]+M(e,s),r[0][1]+M(e,s)]),t.push([r[0][0]+M(e,s),r[0][1]+M(e,s)]);for(let n=1;n<r.length;n++)t.push([r[n][0]+M(e,s),r[n][1]+M(e,s)]),n===r.length-1&&t.push([r[n][0]+M(e,s),r[n][1]+M(e,s)]);return J(t,null,s)}function J(r,e,s){const t=r.length,n=[];if(t>3){const o=[],h=1-s.curveTightness;n.push({op:"move",data:[r[1][0],r[1][1]]});for(let a=1;a+2<t;a++){const c=r[a];o[0]=[c[0],c[1]],o[1]=[c[0]+(h*r[a+1][0]-h*r[a-1][0])/6,c[1]+(h*r[a+1][1]-h*r[a-1][1])/6],o[2]=[r[a+1][0]+(h*r[a][0]-h*r[a+2][0])/6,r[a+1][1]+(h*r[a][1]-h*r[a+2][1])/6],o[3]=[r[a+1][0],r[a+1][1]],n.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}if(e&&e.length===2){const a=s.maxRandomnessOffset;n.push({op:"lineTo",data:[e[0]+M(a,s),e[1]+M(a,s)]})}}else t===3?(n.push({op:"move",data:[r[1][0],r[1][1]]}),n.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[2][0],r[2][1]]})):t===2&&n.push(...N(r[0][0],r[0][1],r[1][0],r[1][1],s));return n}function mt(r,e,s,t,n,o,h,a){const c=[],p=[];if(a.roughness===0){r/=4,p.push([e+t*Math.cos(-r),s+n*Math.sin(-r)]);for(let i=0;i<=2*Math.PI;i+=r){const d=[e+t*Math.cos(i),s+n*Math.sin(i)];c.push(d),p.push(d)}p.push([e+t*Math.cos(0),s+n*Math.sin(0)]),p.push([e+t*Math.cos(r),s+n*Math.sin(r)])}else{const i=M(.5,a)-Math.PI/2;p.push([M(o,a)+e+.9*t*Math.cos(i-r),M(o,a)+s+.9*n*Math.sin(i-r)]);const d=2*Math.PI+i-.01;for(let f=i;f<d;f+=r){const u=[M(o,a)+e+t*Math.cos(f),M(o,a)+s+n*Math.sin(f)];c.push(u),p.push(u)}p.push([M(o,a)+e+t*Math.cos(i+2*Math.PI+.5*h),M(o,a)+s+n*Math.sin(i+2*Math.PI+.5*h)]),p.push([M(o,a)+e+.98*t*Math.cos(i+h),M(o,a)+s+.98*n*Math.sin(i+h)]),p.push([M(o,a)+e+.9*t*Math.cos(i+.5*h),M(o,a)+s+.9*n*Math.sin(i+.5*h)])}return[p,c]}function Mt(r,e,s,t,n,o,h,a,c){const p=o+M(.1,c),i=[];i.push([M(a,c)+e+.9*t*Math.cos(p-r),M(a,c)+s+.9*n*Math.sin(p-r)]);for(let d=p;d<=h;d+=r)i.push([M(a,c)+e+t*Math.cos(d),M(a,c)+s+n*Math.sin(d)]);return i.push([e+t*Math.cos(h),s+n*Math.sin(h)]),i.push([e+t*Math.cos(h),s+n*Math.sin(h)]),J(i,null,c)}function Ft(r,e,s,t,n,o,h,a){const c=[],p=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3];let i=[0,0];const d=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let u=0;u<d;u++)u===0?c.push({op:"move",data:[h[0],h[1]]}):c.push({op:"move",data:[h[0]+(f?0:M(p[0],a)),h[1]+(f?0:M(p[0],a))]}),i=f?[n,o]:[n+M(p[u],a),o+M(p[u],a)],c.push({op:"bcurveTo",data:[r+M(p[u],a),e+M(p[u],a),s+M(p[u],a),t+M(p[u],a),i[0],i[1]]});return c}function V(r){return[...r]}function K(r,e){return Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2)}function Bt(r,e,s){const t=K(e,s);if(t===0)return K(r,e);let n=((r[0]-e[0])*(s[0]-e[0])+(r[1]-e[1])*(s[1]-e[1]))/t;return n=Math.max(0,Math.min(1,n)),K(r,D(e,s,n))}function D(r,e,s){return[r[0]+(e[0]-r[0])*s,r[1]+(e[1]-r[1])*s]}function at(r,e,s,t){const n=t||[];if(function(a,c){const p=a[c+0],i=a[c+1],d=a[c+2],f=a[c+3];let u=3*i[0]-2*p[0]-f[0];u*=u;let l=3*i[1]-2*p[1]-f[1];l*=l;let m=3*d[0]-2*f[0]-p[0];m*=m;let g=3*d[1]-2*f[1]-p[1];return g*=g,u<m&&(u=m),l<g&&(l=g),u+l}(r,e)<s){const a=r[e+0];n.length?(o=n[n.length-1],h=a,Math.sqrt(K(o,h))>1&&n.push(a)):n.push(a),n.push(r[e+3])}else{const c=r[e+0],p=r[e+1],i=r[e+2],d=r[e+3],f=D(c,p,.5),u=D(p,i,.5),l=D(i,d,.5),m=D(f,u,.5),g=D(u,l,.5),k=D(m,g,.5);at([c,f,m,k],0,s,n),at([k,g,l,d],0,s,n)}var o,h;return n}function Zt(r,e){return U(r,0,r.length,e)}function U(r,e,s,t,n){const o=n||[],h=r[e],a=r[s-1];let c=0,p=1;for(let i=e+1;i<s-1;++i){const d=Bt(r[i],h,a);d>c&&(c=d,p=i)}return Math.sqrt(c)>t?(U(r,e,p+1,t,o),U(r,p,s,t,o)):(o.length||o.push(h),o.push(a)),o}function kt(r,e=.15,s){const t=[],n=(r.length-1)/3;for(let o=0;o<n;o++)at(r,3*o,e,t);return s&&s>0?U(t,0,t.length,s):t}const S="none";class X{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,s,t){return{shape:e,sets:s||[],options:t||this.defaultOptions}}line(e,s,t,n,o){const h=this._o(o);return this._d("line",[ct(e,s,t,n,h)],h)}rectangle(e,s,t,n,o){const h=this._o(o),a=[],c=Gt(e,s,t,n,h);if(h.fill){const p=[[e,s],[e+t,s],[e+t,s+n],[e,s+n]];h.fillStyle==="solid"?a.push(Q([p],h)):a.push(I([p],h))}return h.stroke!==S&&a.push(c),this._d("rectangle",a,h)}ellipse(e,s,t,n,o){const h=this._o(o),a=[],c=ut(t,n,h),p=ot(e,s,h,c);if(h.fill)if(h.fillStyle==="solid"){const i=ot(e,s,h,c).opset;i.type="fillPath",a.push(i)}else a.push(I([p.estimatedPoints],h));return h.stroke!==S&&a.push(p.opset),this._d("ellipse",a,h)}circle(e,s,t,n){const o=this.ellipse(e,s,t,t,n);return o.shape="circle",o}linearPath(e,s){const t=this._o(s);return this._d("linearPath",[Z(e,!1,t)],t)}arc(e,s,t,n,o,h,a=!1,c){const p=this._o(c),i=[],d=pt(e,s,t,n,o,h,a,!0,p);if(a&&p.fill)if(p.fillStyle==="solid"){const f=Object.assign({},p);f.disableMultiStroke=!0;const u=pt(e,s,t,n,o,h,!0,!1,f);u.type="fillPath",i.push(u)}else i.push(function(f,u,l,m,g,k,y){const O=f,R=u;let b=Math.abs(l/2),_=Math.abs(m/2);b+=M(.01*b,y),_+=M(.01*_,y);let q=g,T=k;for(;q<0;)q+=2*Math.PI,T+=2*Math.PI;T-q>2*Math.PI&&(q=0,T=2*Math.PI);const tt=(T-q)/y.curveStepCount,$=[];for(let E=q;E<=T;E+=tt)$.push([O+b*Math.cos(E),R+_*Math.sin(E)]);return $.push([O+b*Math.cos(T),R+_*Math.sin(T)]),$.push([O,R]),I([$],y)}(e,s,t,n,o,h,p));return p.stroke!==S&&i.push(d),this._d("arc",i,p)}curve(e,s){const t=this._o(s),n=[],o=Vt(e,t);if(t.fill&&t.fill!==S&&e.length>=3){const h=kt(function(a,c=0){const p=a.length;if(p<3)throw new Error("A curve must have at least three points.");const i=[];if(p===3)i.push(V(a[0]),V(a[1]),V(a[2]),V(a[2]));else{const d=[];d.push(a[0],a[0]);for(let l=1;l<a.length;l++)d.push(a[l]),l===a.length-1&&d.push(a[l]);const f=[],u=1-c;i.push(V(d[0]));for(let l=1;l+2<d.length;l++){const m=d[l];f[0]=[m[0],m[1]],f[1]=[m[0]+(u*d[l+1][0]-u*d[l-1][0])/6,m[1]+(u*d[l+1][1]-u*d[l-1][1])/6],f[2]=[d[l+1][0]+(u*d[l][0]-u*d[l+2][0])/6,d[l+1][1]+(u*d[l][1]-u*d[l+2][1])/6],f[3]=[d[l+1][0],d[l+1][1]],i.push(f[1],f[2],f[3])}}return i}(e),10,(1+t.roughness)/2);t.fillStyle==="solid"?n.push(Q([h],t)):n.push(I([h],t))}return t.stroke!==S&&n.push(o),this._d("curve",n,t)}polygon(e,s){const t=this._o(s),n=[],o=Z(e,!0,t);return t.fill&&(t.fillStyle==="solid"?n.push(Q([e],t)):n.push(I([e],t))),t.stroke!==S&&n.push(o),this._d("polygon",n,t)}path(e,s){const t=this._o(s),n=[];if(!e)return this._d("path",n,t);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const o=t.fill&&t.fill!=="transparent"&&t.fill!==S,h=t.stroke!==S,a=!!(t.simplification&&t.simplification<1),c=function(p,i,d){const f=it(ht(rt(p))),u=[];let l=[],m=[0,0],g=[];const k=()=>{g.length>=4&&l.push(...kt(g,i)),g=[]},y=()=>{k(),l.length&&(u.push(l),l=[])};for(const{key:R,data:b}of f)switch(R){case"M":y(),m=[b[0],b[1]],l.push(m);break;case"L":k(),l.push([b[0],b[1]]);break;case"C":if(!g.length){const _=l.length?l[l.length-1]:m;g.push([_[0],_[1]])}g.push([b[0],b[1]]),g.push([b[2],b[3]]),g.push([b[4],b[5]]);break;case"Z":k(),l.push([m[0],m[1]])}if(y(),!d)return u;const O=[];for(const R of u){const b=Zt(R,d);b.length&&O.push(b)}return O}(e,1,a?4-4*t.simplification:(1+t.roughness)/2);return o&&(t.fillStyle==="solid"?n.push(Q(c,t)):n.push(I(c,t))),h&&(a?c.forEach(p=>{n.push(Z(p,!1,t))}):n.push(function(p,i){const d=it(ht(rt(p))),f=[];let u=[0,0],l=[0,0];for(const{key:m,data:g}of d)switch(m){case"M":{const k=1*(i.maxRandomnessOffset||0),y=i.preserveVertices;f.push({op:"move",data:g.map(O=>O+(y?0:M(k,i)))}),l=[g[0],g[1]],u=[g[0],g[1]];break}case"L":f.push(...N(l[0],l[1],g[0],g[1],i)),l=[g[0],g[1]];break;case"C":{const[k,y,O,R,b,_]=g;f.push(...Ft(k,y,O,R,b,_,l,i)),l=[b,_];break}case"Z":f.push(...N(l[0],l[1],u[0],u[1],i)),l=[u[0],u[1]]}return{type:"path",ops:f}}(e,t))),this._d("path",n,t)}opsToPath(e,s){let t="";for(const n of e.ops){const o=typeof s=="number"&&s>=0?n.data.map(h=>+h.toFixed(s)):n.data;switch(n.op){case"move":t+=`M${o[0]} ${o[1]} `;break;case"bcurveTo":t+=`C${o[0]} ${o[1]}, ${o[2]} ${o[3]}, ${o[4]} ${o[5]} `;break;case"lineTo":t+=`L${o[0]} ${o[1]} `}}return t.trim()}toPaths(e){const s=e.sets||[],t=e.options||this.defaultOptions,n=[];for(const o of s){let h=null;switch(o.type){case"path":h={d:this.opsToPath(o),stroke:t.stroke,strokeWidth:t.strokeWidth,fill:S};break;case"fillPath":h={d:this.opsToPath(o),stroke:S,strokeWidth:0,fill:t.fill||S};break;case"fillSketch":h=this.fillSketch(o,t)}h&&n.push(h)}return n}fillSketch(e,s){let t=s.fillWeight;return t<0&&(t=s.strokeWidth/2),{d:this.opsToPath(e),stroke:s.fill||S,strokeWidth:t,fill:S}}}class Qt{constructor(e,s){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new X(s)}draw(e){const s=e.sets||[],t=e.options||this.getDefaultOptions(),n=this.ctx,o=e.options.fixedDecimalPlaceDigits;for(const h of s)switch(h.type){case"path":n.save(),n.strokeStyle=t.stroke==="none"?"transparent":t.stroke,n.lineWidth=t.strokeWidth,t.strokeLineDash&&n.setLineDash(t.strokeLineDash),t.strokeLineDashOffset&&(n.lineDashOffset=t.strokeLineDashOffset),this._drawToContext(n,h,o),n.restore();break;case"fillPath":{n.save(),n.fillStyle=t.fill||"";const a=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(n,h,o,a),n.restore();break}case"fillSketch":this.fillSketch(n,h,t)}}fillSketch(e,s,t){let n=t.fillWeight;n<0&&(n=t.strokeWidth/2),e.save(),t.fillLineDash&&e.setLineDash(t.fillLineDash),t.fillLineDashOffset&&(e.lineDashOffset=t.fillLineDashOffset),e.strokeStyle=t.fill||"",e.lineWidth=n,this._drawToContext(e,s,t.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,s,t,n="nonzero"){e.beginPath();for(const o of s.ops){const h=typeof t=="number"&&t>=0?o.data.map(a=>+a.toFixed(t)):o.data;switch(o.op){case"move":e.moveTo(h[0],h[1]);break;case"bcurveTo":e.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"lineTo":e.lineTo(h[0],h[1])}}s.type==="fillPath"?e.fill(n):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,s,t,n,o){const h=this.gen.line(e,s,t,n,o);return this.draw(h),h}rectangle(e,s,t,n,o){const h=this.gen.rectangle(e,s,t,n,o);return this.draw(h),h}ellipse(e,s,t,n,o){const h=this.gen.ellipse(e,s,t,n,o);return this.draw(h),h}circle(e,s,t,n){const o=this.gen.circle(e,s,t,n);return this.draw(o),o}linearPath(e,s){const t=this.gen.linearPath(e,s);return this.draw(t),t}polygon(e,s){const t=this.gen.polygon(e,s);return this.draw(t),t}arc(e,s,t,n,o,h,a=!1,c){const p=this.gen.arc(e,s,t,n,o,h,a,c);return this.draw(p),p}curve(e,s){const t=this.gen.curve(e,s);return this.draw(t),t}path(e,s){const t=this.gen.path(e,s);return this.draw(t),t}}const Y="http://www.w3.org/2000/svg";class Ht{constructor(e,s){this.svg=e,this.gen=new X(s)}draw(e){const s=e.sets||[],t=e.options||this.getDefaultOptions(),n=this.svg.ownerDocument||window.document,o=n.createElementNS(Y,"g"),h=e.options.fixedDecimalPlaceDigits;for(const a of s){let c=null;switch(a.type){case"path":c=n.createElementNS(Y,"path"),c.setAttribute("d",this.opsToPath(a,h)),c.setAttribute("stroke",t.stroke),c.setAttribute("stroke-width",t.strokeWidth+""),c.setAttribute("fill","none"),t.strokeLineDash&&c.setAttribute("stroke-dasharray",t.strokeLineDash.join(" ").trim()),t.strokeLineDashOffset&&c.setAttribute("stroke-dashoffset",`${t.strokeLineDashOffset}`);break;case"fillPath":c=n.createElementNS(Y,"path"),c.setAttribute("d",this.opsToPath(a,h)),c.setAttribute("stroke","none"),c.setAttribute("stroke-width","0"),c.setAttribute("fill",t.fill||""),e.shape!=="curve"&&e.shape!=="polygon"||c.setAttribute("fill-rule","evenodd");break;case"fillSketch":c=this.fillSketch(n,a,t)}c&&o.appendChild(c)}return o}fillSketch(e,s,t){let n=t.fillWeight;n<0&&(n=t.strokeWidth/2);const o=e.createElementNS(Y,"path");return o.setAttribute("d",this.opsToPath(s,t.fixedDecimalPlaceDigits)),o.setAttribute("stroke",t.fill||""),o.setAttribute("stroke-width",n+""),o.setAttribute("fill","none"),t.fillLineDash&&o.setAttribute("stroke-dasharray",t.fillLineDash.join(" ").trim()),t.fillLineDashOffset&&o.setAttribute("stroke-dashoffset",`${t.fillLineDashOffset}`),o}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,s){return this.gen.opsToPath(e,s)}line(e,s,t,n,o){const h=this.gen.line(e,s,t,n,o);return this.draw(h)}rectangle(e,s,t,n,o){const h=this.gen.rectangle(e,s,t,n,o);return this.draw(h)}ellipse(e,s,t,n,o){const h=this.gen.ellipse(e,s,t,n,o);return this.draw(h)}circle(e,s,t,n){const o=this.gen.circle(e,s,t,n);return this.draw(o)}linearPath(e,s){const t=this.gen.linearPath(e,s);return this.draw(t)}polygon(e,s){const t=this.gen.polygon(e,s);return this.draw(t)}arc(e,s,t,n,o,h,a=!1,c){const p=this.gen.arc(e,s,t,n,o,h,a,c);return this.draw(p)}curve(e,s){const t=this.gen.curve(e,s);return this.draw(t)}path(e,s){const t=this.gen.path(e,s);return this.draw(t)}}var Jt={canvas:(r,e)=>new Qt(r,e),svg:(r,e)=>new Ht(r,e),generator:r=>new X(r),newSeed:()=>X.newSeed()};const yt=(r,e)=>{const s=r.__vccOpts||r;for(const[t,n]of e)s[t]=n;return s},Kt={name:"RoughCanvas",props:{width:String,height:String,config:Object},setup(r){const e=x.ref(null),s=x.ref(null);return x.onMounted(()=>{s.value=Jt.canvas(e.value,r.config)}),{rough:s,canvasRef:e}}},Ut=["width","height"];function Xt(r,e,s,t,n,o){return x.openBlock(),x.createElementBlock("canvas",{width:s.width,height:s.height,ref:"canvasRef"},[t.rough?x.renderSlot(r.$slots,"default",{key:0}):x.createCommentVNode("",!0)],8,Ut)}const bt=yt(Kt,[["render",Xt]]),Yt={name:"RoughSvg",props:{width:String,height:String,config:Object},setup(r){const e=x.ref(null),s=x.ref(null);return x.onMounted(()=>{s.value=s.svg(e.value,r.config)}),{rough:s,append:o=>{e.value.appendChild(o)},remove:o=>{e.value.removeChild(o)}}}},te=["width","height"];function ee(r,e,s,t,n,o){return x.openBlock(),x.createElementBlock("svg",{width:s.width,height:s.height,ref:"svgElement"},[t.rough?x.renderSlot(r.$slots,"default",{key:0}):x.createCommentVNode("",!0)],8,te)}const wt=yt(Yt,[["render",ee]]),A={props:{roughness:Number,bowing:Number,seed:Number,stroke:String,strokeWidth:Number,fill:String,fillStyle:String,fillWeight:Number,hachureAngle:Number,hachureGap:Number,curveStepCount:Number,curveFitting:Number,strokeLineDash:Array,strokeLineDashOffset:Number,fillLineDash:Array,fillLineDashOffset:Number,disableMultiStroke:Boolean,disableMultiStrokeFill:Boolean,simplification:Number,dashOffset:Number,dashGap:Number,zigzagOffset:Number},data(){return{element:null}},mounted(){this.$watch("$props",()=>{this.handler()},{deep:!0}),this.handler()},render(){return this.$slots.default?this.$slots.default():[]},destroyed(){this.$parent.rough.svg?this.element&&this.$parent.remove(this.element):this.$parent.$emit("rerender")},methods:{createElement:function(r,e,s=!1){const t=this.$parent.rough;if(!t){console.error("Parent component does not provide a Rough.js instance.");return}const n=Object.assign({},...Object.entries(this.$props).map(([o,h])=>h!==void 0&&{[o]:h}));if(s){t[r](...e,n);return}t!=null&&t.svg?(this.element&&this.$parent.remove(this.element),this.element=t[r](...e,n),this.$parent.append(this.element)):this.$parent.$emit("rerender")}}},xt={name:"RoughLine",mixins:[A],props:{x1:{type:Number,default:0,required:!0},y1:{type:Number,default:0,required:!0},x2:{type:Number,default:0,required:!0},y2:{type:Number,default:0,required:!0}},methods:{handler(r=!1){this.createElement("line",[this.x1,this.y1,this.x2,this.y2],r)}}},vt={name:"RoughRectangle",mixins:[A],props:{x1:{type:Number,default:0,required:!0},y1:{type:Number,default:0,required:!0},x2:{type:Number,default:0,required:!0},y2:{type:Number,default:0,required:!0}},methods:{handler(r=!1){this.createElement("rectangle",[this.x1,this.y1,this.x2,this.y2],r)}}},Pt={name:"RoughEllipse",mixins:[A],props:{x:{type:Number,default:0,required:!0},y:{type:Number,default:0,required:!0},width:{type:Number,default:0,required:!0},height:{type:Number,default:0,required:!0}},methods:{handler(r=!1){this.createElement("ellipse",[this.x,this.y,this.width,this.height],r)}}},St={name:"RoughCircle",mixins:[A],props:{x:{type:Number,default:0,required:!0},y:{type:Number,default:0,required:!0},diameter:{type:Number,default:0,required:!0}},methods:{handler(r=!1){this.createElement("circle",[this.x,this.y,this.diameter],r)}}},_t={name:"RoughLinearPath",mixins:[A],props:{points:{type:Array,required:!0}},methods:{handler(r=!1){this.createElement("linearPath",[this.points],r)}}},Ot={name:"RoughPolygon",mixins:[A],props:{vertices:{type:Array,required:!0}},methods:{handler(r=!1){this.createElement("polygon",[this.vertices],r)}}},Lt={name:"RoughArc",mixins:[A],props:{x:{type:Number,default:0,required:!0},y:{type:Number,default:0,required:!0},width:{type:Number,default:0,required:!0},height:{type:Number,default:0,required:!0},start:{type:Number,default:0,required:!0},stop:{type:Number,default:0,required:!0},closed:{type:Boolean,default:!1,required:!0}},methods:{handler(r=!1){this.createElement("arc",[this.x,this.y,this.width,this.height,this.start,this.stop,this.closed],r)}}},Rt={name:"RoughCurve",mixins:[A],props:{points:{type:Array,required:!0}},methods:{handler(r=!1){this.createElement("curve",[this.points],r)}}},$t={name:"RoughPath",mixins:[A],props:{d:{type:String,required:!0}},methods:{handler(r=!1){this.createElement("path",[this.d],r)}}},Tt=Object.freeze(Object.defineProperty({__proto__:null,RoughArc:Lt,RoughCanvas:bt,RoughCircle:St,RoughCurve:Rt,RoughEllipse:Pt,RoughLine:xt,RoughLinearPath:_t,RoughPath:$t,RoughPolygon:Ot,RoughRectangle:vt,RoughSvg:wt},Symbol.toStringTag,{value:"Module"}));function Ct(r){Object.keys(Tt).forEach(e=>{r.component(e,Tt[e])})}w.RoughArc=Lt,w.RoughCanvas=bt,w.RoughCircle=St,w.RoughCurve=Rt,w.RoughEllipse=Pt,w.RoughLine=xt,w.RoughLinearPath=_t,w.RoughPath=$t,w.RoughPolygon=Ot,w.RoughRectangle=vt,w.RoughSvg=wt,w.default=Ct,w.install=Ct,Object.defineProperties(w,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
